// Waypoint: Browser Edition
// Written by Luke Morton, MIT licensed.
!function(a){typeof define=="function"&&define.amd?define(a):this.waypoint=a()}(function(){function a(b){return a[b]}return a["./route"]=new function(){var a=this;((function(){var b,c,d;b=function(){function a(a){a.uri!=null&&(this.regex=a.uri),this.regex instanceof RegExp||(this.regex=d(this.regex,{})),a.method!=null&&(this.method=a.method.toUpperCase()),this.method||(this.method="GET"),a.callback!=null&&(this.callback=a.callback)}return a.prototype.match=function(a){var b;return a.method!=null&&this.method!==a.method.toUpperCase()?!1:(b=this.regex.exec(a.uri),b&&b.length!=null?b.slice(1):!1)},a}(),c=function(a,b,c){var d,e,f;c=a;for(e=0,f=b.length;e<f;e++){d=b[e];if(b.hasOwnProperty(d)){c=b[d](a);if(c!==a)break}}return c===a?"([a-zA-Z0-9-]+)":c},d=function(a,b){var d,e,f,g;a.indexOf(!0)&&(a=a.replace(/\*/g,"([_.()!\\ %@&a-zA-Z0-9-]+)")),e=a.match(/:([^\/]+)/ig);if(e)for(f=0,g=e.length;f<g;f++)d=e[f],a=a.replace(d,c(d,b));return new RegExp("^"+a+"$")},b.get=function(a,c){return new b({uri:a,method:"GET",callback:c})},b.post=function(a,c){return new b({uri:a,method:"POST",callback:c})},a.Route=b})).call(this)},a["./router"]=new function(){var b=this;((function(){var c,d,e;c=a("./route").Route,Array.isArray||(Array.isArray=function(a){return Object.prototype.toString.call(a)==="[object Array]"}),d=function(){function a(a){a&&a.routes!=null&&this.routes(a.routes)}return a.prototype._routes=[],a.prototype.routes=function(a){return a!=null&&(this._routes=a),this._routes},a.prototype.route=function(a){return a instanceof c||(a=new c(a)),this._routes.push(a)},a.prototype.routeMap=function(a,b){var c,d,f,g,h;b==null&&(b=""),h=[];for(f in a){c=a[f],g=e(f),f=g[0],d=g[1],f=b+f;if(typeof c=="function"||Array.isArray(c))h.push(this.route({uri:f,method:d,callback:c}));else if(typeof c=="object")h.push(this.routeMap(c,f));else throw"Map must be string array or object"}return h},a.prototype.dispatch=function(a){var b,c,d,e,f,g,h,i,j;typeof a=="string"&&(a={uri:a,method:"get"}),j=this.routes();for(f=0,h=j.length;f<h;f++){e=j[f],d=e.match(a);if(!d)continue;Array.isArray(e.callback)?c=e.callback:c=[e.callback];for(g=0,i=c.length;g<i;g++)b=c[g],b.apply(e,d);!0}return!1},a}(),e=function(a){var b,c;return b=a.match(/^(GET|POST) (.+)/),b&&b[1]&&(c=b[1]),b&&b[2]&&(a=b[2]),[a,c]},b.Router=d})).call(this)},{Route:a("./route").Route,Router:a("./router").Router}})