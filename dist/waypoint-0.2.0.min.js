// Waypoint: Browser Edition
// Written by Luke Morton, MIT licensed.
!function(a){typeof define=="function"&&define.amd?define(a):this.waypoint=a()}(function(){function a(b){return a[b]}return a["./route"]=new function(){var a=this;((function(){var b,c,d;b=function(){function a(a,b,c){c==null&&(c=b,b=a,a="GET"),b instanceof RegExp||(this.regex=d(b,{})),this.method=a.toUpperCase(),c!=null&&(this.callback=c)}return a.prototype.match=function(a,b){var c;return b==null&&(b=a,a=null),a!=null&&this.method!==a.toUpperCase()?!1:(c=this.regex.exec(b),c&&c.length!=null?c.slice(1):!1)},a}(),c=function(a,b,c){var d,e,f;c=a;for(e=0,f=b.length;e<f;e++){d=b[e];if(b.hasOwnProperty(d)){c=b[d](a);if(c!==a)break}}return c===a?"([a-zA-Z0-9-]+)":c},d=function(a,b){var d,e,f,g;a.indexOf(!0)&&(a=a.replace(/\*/g,"([_.()!\\ %@&a-zA-Z0-9-]+)")),e=a.match(/:([^\/]+)/ig);if(e)for(f=0,g=e.length;f<g;f++)d=e[f],a=a.replace(d,c(d,b));return new RegExp("^"+a+"$")},a.Route=b})).call(this)},a["./router"]=new function(){var b=this;((function(){var c,d,e;c=a("./route").Route,Array.isArray||(Array.isArray=function(a){return Object.prototype.toString.call(a)==="[object Array]"}),d=function(){function a(a){var b,c,d,e;if(a){e=["routes","baseUri","notFound"];for(c=0,d=e.length;c<d;c++)b=e[c],a[b]!=null&&(this[b]=a[b]);a.routeMap!=null&&this.routeMap(a.routeMap)}}return a.prototype.baseUri="",a.prototype.routes=[],a.prototype.notFound=function(){},a.prototype.route=function(a,b,d){var e;return a instanceof c?e=a:e=new c(a,b,d),this.routes.push(e)},a.prototype.get=function(a,b){return this.route("GET",a,b)},a.prototype.post=function(a,b){return this.route("POST",a,b)},a.prototype.routeMap=function(a,b){var c,d,f,g,h;b==null&&(b=this.baseUri),h=[];for(f in a){c=a[f],g=e(f),f=g[0],d=g[1],f=b+f;if(typeof c=="function"||Array.isArray(c))h.push(this.route(d,f,c));else if(typeof c=="object")h.push(this.routeMap(c,f));else throw"Map must be string array or object"}return h},a.prototype.dispatch=function(a,b){var c,d,e,f,g,h,i,j,k;k=this.routes;for(g=0,i=k.length;g<i;g++){f=k[g],e=f.match(a,b);if(!e)continue;Array.isArray(f.callback)?d=f.callback:d=[f.callback];for(h=0,j=d.length;h<j;h++)c=d[h],c.apply(f,e);return!0}return this.notFound(),!1},a}(),e=function(a){var b,c,d;return b=a.match(/^(GET|POST) (.+)/),b&&b.length!=null?(d=b.slice(1,3).reverse(),a=d[0],c=d[1],c||(c="GET"),[a,c]):[a||"","GET"]},b.Router=d})).call(this)},{Route:a("./route").Route,Router:a("./router").Router}})